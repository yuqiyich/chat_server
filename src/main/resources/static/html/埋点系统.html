<h2><a href="#数据埋点统计系统" id="数据埋点统计系统">数据埋点统计系统</a></h2>
<ul>
    <li>提供一套简单的埋点记录上传查看机制，用于客户端统计客户端模块想要记录的数据。目前主要用于【乘客上车点、司机定位、司机算路的降级生效记录】等功能。</li>
</ul>
<h3><a href="#迭代说明" id="迭代说明">迭代说明</a></h3>
<p>V1.0.1</p>
<ul>
    <li>司机算路增加兜底失败上报事件、增加订单ID上报、增加上报场景。</li>
    <li>司机定位增加兜底失败上报事件、增加订单ID上报、增加上报场景。</li>
    <li>乘客上车点增加兜底失败上报事件、增加兜底成功关联订单ID上报、如祺缓存解析点事件拆分为APP本地GEO兜底和APP本地推荐点兜底两个事件。</li>
    <li>中台支持司机算路、司机定位的场景查询；中台支持乘客上车点是否关联订单查询。</li>
    <li>iOS与Android同步方案逻辑调整。</li>
    <li>问题：</li>
    <li>遗留问题：客户端离线上报功能、中台查看订单数和用户数功能。</li>
</ul>
<p>V1.0.0</p>
<ul>
    <li>司机定位缓存点生效记录、司机算路降级生效记录、乘客推荐点降级生效记录。简单计数。</li>
    <li>问题：Android与iOS相关逻辑不一致，导致上报逻辑次数等不一致；iOS端需要调整APPKEY；iOS需要调整网络状态字段；未关联订单；未区分场景；未统计兜底失败。</li>
</ul>
<h3><a href="#通用基础介绍" id="通用基础介绍">通用基础介绍</a></h3>
<p>1、目前项目部署环境仅一套，部署的服务器为公司项目测试环境的服务器，作为该项目唯一的一套环境（prod）。</p>
<p>2、管理后台地址 <a href="https://weixintest.ruqimobility.com/manager/login.html">https://weixintest.ruqimobility.com/manager/login.html</a>，
    登录账号：admin，密码：ruqi123456。</p>
<p>3、API接口（暂未做数据加解密处理，目前提供给APP端使用的接口也不校验token）</p>
<blockquote>
    <p>HOST：https://weixintest.ruqimobility.com/<br />
        PATH：manager/<br />
        UrlSuffix：</p>
    <ul>
        <li>record/uploadDotEventData （通用简单埋点事件统计上报）</li>
    </ul>
</blockquote>
<p>4、Swagger地址（可在线简单测试接口，暂未详细标示字段注释、必填属性等）： <a href="https://weixintest.ruqimobility.com/manager/swagger-ui.html">https://weixintest.ruqimobility.com/manager/swagger-ui.html</a></p>
<p>5、目前的APPKEY，同一个应用仅区分两个环境：dev、prod。对应客户端的开发、测试环境使用开发环境的key，正式环境使用正式环境的key。目前APPKEY值保存在数据库中。</p>
<h3><a href="#详细介绍" id="详细介绍">详细介绍</a></h3>
<p>1、接口详细说明</p>
<ul>
    <li>POST请求</li>
    <li>上报接口URL完整路径：https://weixintest.ruqimobility.com/manager/record/uploadDotEventData</li>
    <li>参数示例：</li>
</ul>
<pre><code>{
  &quot;appInfo&quot;: {
    &quot;appKey&quot;: &quot;&quot; // 必填。环境不同或应用不同则appKey不同
  },
  &quot;content&quot;: {
    &quot;appVersionCode&quot;: 0,
    &quot;appVersionName&quot;: &quot;string&quot;,
    &quot;channel&quot;: &quot;string&quot;, // 渠道
    &quot;deviceBrand&quot;: &quot;string&quot;, // 设备品牌
    &quot;deviceId&quot;: &quot;string&quot;, // 设备ID
    &quot;deviceModel&quot;: &quot;string&quot;, // 设备型号
    &quot;eventDetail&quot;: &quot;&quot;, // 事件详情，选填
    &quot;eventKey&quot;: &quot;&quot;, // 必填。事件KEY
    &quot;ext&quot;: &quot;string&quot;, // 后续扩展字段，选填
    &quot;locationLat&quot;: 0, // 事件触发时的纬度
    &quot;locationLng&quot;: 0, // 事件触发时的经度
    &quot;netState&quot;: &quot;string&quot;, // 网络类型，如WIFI、4G等
    &quot;platform&quot;: &quot;iOS&quot;, // 必填。系统平台，如Android、iOS
    &quot;systemVersion&quot;: &quot;string&quot;, // 系统版本，如9.0
    //-----------V1.0.1新增字段 start-----------
    &quot;orderId&quot;: &quot;string&quot;, // 订单ID
    &quot;scene&quot;: &quot;string&quot;, // 场景 1：接驾；2：送驾
    //-----------V1.0.1新增字段 end-----------
  },
  &quot;userInfo&quot;: {
    &quot;nickName&quot;:&quot;string&quot;, // 昵称
    &quot;userId&quot;:&quot;string&quot;, // 用户ID
    &quot;userPhone&quot;:&quot;string&quot; // 手机号
  },
  &quot;recordType&quot;: 1001 // 必填。记录类型，通用埋点上报固定传1001
}
</code></pre>
<ul>
    <li>返回值。目前返回<code>{ &quot;errorCode&quot;: 0, &quot;errorMsg&quot;: &quot;&quot; }</code>。未按照标准接口返回请求结果。业务侧异步调用接口上报数据后也不需关注接口请求结果。</li>
</ul>
<p>2、报表查看</p>
<ul>
    <li><strong>以乘客推荐点降级生效记录为例</strong></li>
</ul>
<ol>
    <li>入口路径：登录管理后台，左侧菜单栏【数据埋点系统】-&gt;【推荐点降级生效记录】。</li>
    <li>筛选条件：应用类型（乘客/乘客dev）、系统平台（Android/iOS）、生效类型（腾讯推荐点生效/腾讯GEO点生效/如祺缓存解析点生效）、app版本、设备型号、设备品牌、用户ID、设备ID、时间段。</li>
    <li>数据查看：生效类型、应用名称、系统平台、用户ID、设备ID、详情、上报时间、系统版本、网络状态、经度、纬度、渠道、版本ID、版本名称、设备型号、设备品牌、IP、备注。</li>
</ol>
<p>3、事件Key说明</p>
<p><strong>乘客推荐点降级生效记录</strong></p>
<table border="1" cellspacing="0">
    <thead>
    <tr><th align="center">KEY </th><th align="center"> 说明</th></tr>
    </thead>
    <tbody>
    <tr><td align="center">FALLBACK_SUCCESS_TX_RECOMMEND </td><td align="center"> 腾讯推荐点生效</td></tr>
    <tr><td align="center">FALLBACK_SUCCESS_TX_GEO </td><td align="center"> 腾讯GEO点生效</td></tr>
    <tr><td align="center">FALLBACK_SUCCESS_RUQI_GEO </td><td align="center"> APP本地GEO兜底</td></tr>
    <tr><td align="center">FALLBACK_SUCCESS_RUQI_RECOMMEND </td><td align="center"> APP本地推荐点兜底</td></tr>
    <tr><td align="center">上面4个KEY之一 </td><td align="center"> 兜底订单关联（上报订单ID）</td></tr>
    <tr><td align="center">FALLBACK_FAIL_BOARDING_POINT </td><td align="center"> 兜底失败</td></tr>
    </tbody>
</table>
<p><strong>司机算路降级生效记录</strong></p>
<table border="1" cellspacing="0">
    <thead>
    <tr><th align="center">KEY </th><th align="center"> 说明</th></tr>
    </thead>
    <tbody>
    <tr><td align="center">FALLBACK_SUCCESS_TX_ROUTE_RETRY </td><td align="center"> 无感知重试成功</td></tr>
    <tr><td align="center">FALLBACK_SUCCESS_TX_ROUTE_CACHE </td><td align="center"> 缓存路线导航</td></tr>
    <tr><td align="center">FALLBACK_SUCCESS_ROUTE_GAODE </td><td align="center"> 第三方导航高德</td></tr>
    <tr><td align="center">FALLBACK_SUCCESS_ROUTE_BAIDU </td><td align="center"> 第三方导航百度</td></tr>
    <tr><td align="center">FALLBACK_SUCCESS_ROUTE_TENCENT </td><td align="center"> 第三方导航腾讯</td></tr>
    <tr><td align="center">FALLBACK_FAIL_ROUTE </td><td align="center"> 兜底失败</td></tr>
    </tbody>
</table>
<p><strong>司机定位缓存点生效记录</strong></p>
<table border="1" cellspacing="0">
    <thead>
    <tr><th align="center">KEY </th><th align="center"> 说明</th></tr>
    </thead>
    <tbody>
    <tr><td align="center">FALLBACK_SUCCESS_TX_HISTORY_LOCATION </td><td align="center"> SDK缓存兜底</td></tr>
    <tr><td align="center">FALLBACK_SUCCESS_TX_DEVICE_LOCATION </td><td align="center"> 原生实时兜底</td></tr>
    <tr><td align="center">FALLBACK_SUCCESS_DEVICE_HISTORY_LOCATION </td><td align="center"> 原生缓存兜底</td></tr>
    <tr><td align="center">FALLBACK_SUCCESS_APP_HISTORY_LOCATION </td><td align="center"> App缓存兜底</td></tr>
    <tr><td align="center">FALLBACK_FAIL_LOCATION </td><td align="center"> 兜底失败</td></tr>
    </tbody>
</table>
<p>4、应用Key说明</p>
<p><strong>暂时只区分了开发和正式，开发和测试环境等非正式情况下统一使用开发key</strong></p>
<table border="1" cellspacing="0">
    <thead>
    <tr><th align="center">ID（表内主键） </th><th align="center"> KEY </th><th align="center"> 说明</th></tr>
    </thead>
    <tbody>
    <tr><td align="center">1 </td><td align="center"> 0EF521E49C6F4BB1 </td><td align="center"> 如祺司机端</td></tr>
    <tr><td align="center">2 </td><td align="center"> BB392D26CF521EFD </td><td align="center"> 如祺乘客端</td></tr>
    <tr><td align="center">3 </td><td align="center"> 8EAB14D70A290C24 </td><td align="center"> 如祺乘客端dev</td></tr>
    <tr><td align="center">4 </td><td align="center"> 6C32597ED4F181D1 </td><td align="center"> 如祺司机端dev</td></tr>
    </tbody>
</table>
<h3><a href="#android-sdk-功能方法" id="android-sdk-功能方法">Android SDK 功能方法</a></h3>
<p>调用方法即可。<br />
    RuqiReporter.trackEvent(eventKey, eventDetail, ext, orderId, scene);</p>

